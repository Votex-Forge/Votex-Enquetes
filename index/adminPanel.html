<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel do Administrador</title>
</head>
<body>
    <h1>Painel do Administrador</h1>
    <div id="adminPanel"></div>
    <button onclick="logout()">Sair</button>
    
    <script>
        // Função para verificar se o usuário é um administrador autenticado
        function checkAdminAuth() {
            const user = JSON.parse(localStorage.getItem("usuarioLogado"));
            if (!user || user.role !== 'admin') {
                alert("Acesso restrito! Somente administradores podem acessar esta página.");
                window.location.href = 'home.html'; // Redireciona para a página inicial
            }
        }

        // Função de logout
        function logout() {
            localStorage.removeItem("usuarioLogado");
            window.location.href = 'home.html'; // Redireciona para a página inicial
        }

        // Função para renderizar o painel de enquetes
        function renderPolls() {
            const polls = JSON.parse(localStorage.getItem('polls')) || [];
            const adminPanel = document.getElementById('adminPanel');
            adminPanel.innerHTML = '<h2>Enquetes Cadastradas</h2>';

            polls.forEach((poll, index) => {
                const pollItem = document.createElement('div');
                pollItem.innerHTML = `
                    <h3>${poll.question}</h3>
                    <p>Expiração: ${new Date(poll.expiration).toLocaleString()}</p>
                    <button onclick="editPoll(${index})">Editar</button>
                    <button onclick="deletePoll(${index})">Excluir</button>
                `;
                adminPanel.appendChild(pollItem);
            });
        }

        // Função para editar uma enquete
        function editPoll(index) {
            const polls = JSON.parse(localStorage.getItem('polls')) || [];
            const poll = polls[index];
            
            const newQuestion = prompt("Editar Pergunta", poll.question);
            const newExpiration = prompt("Editar Data de Expiração", poll.expiration);
            const newOptions = prompt("Editar Opções (separadas por vírgula)", poll.options.join(','));

            if (newQuestion && newExpiration && newOptions) {
                polls[index] = {
                    ...poll,
                    question: newQuestion,
                    expiration: new Date(newExpiration),
                    options: newOptions.split(',').map(option => option.trim())
                };
                localStorage.setItem('polls', JSON.stringify(polls));
                renderPolls(); // Atualiza a lista de enquetes
            }
        }

        // Função para excluir uma enquete
        function deletePoll(index) {
            const polls = JSON.parse(localStorage.getItem('polls')) || [];
            if (confirm("Tem certeza que deseja excluir esta enquete?")) {
                polls.splice(index, 1); // Remove a enquete do array
                localStorage.setItem('polls', JSON.stringify(polls));
                renderPolls(); // Atualiza a lista de enquetes
            }
        }

        // Verifica se o usuário está autenticado como administrador e renderiza o painel
        checkAdminAuth();
        renderPolls();
    </script>
</body>
</html>
